# 보안
  
단일 애플리케이션을 원자 서비스로 분류하면 민첩성, 확장성 및 서비스 재사용 능력이 향상되는 등 다양한 이점이 있다.   
그러나 마이크로 서비스에는 다음과 같은 특별한 보안 요구사항이 있다.

- MITM (Man-in-the-Middle: 중간자공격) 공격을 방어하려면 트래픽 암호화가 필요하다.
- 유연한 서비스 액세스 제어를 제공하려면 상호 TLS 및 세분화 된 액세스 정책이 필요하다.
- 누가 언제 무엇을했는지 파악하려면 감사도구가 필요하다.
   
Istio Security는 이러한 문제를 해결하기위한 포괄적인 보안 솔루션을 제공한다다.   
이 페이지는 Istio 보안기능을 사용하여, 
서비스를 어디에서 실행하든 보안을 유지하는 방법에 대한 개요를 제공한다.   
특히, Istio 보안은 데이터, 엔드 포인트, 통신 및 플랫폼에 대한 내부 및 외부 위협을 모두 완화한다.   
   
![Istio 보안 개념](https://istio.io/latest/docs/concepts/security/overview.svg)   
   
Istio 보안기능은 강력한 ID, 강력한 정책, 투명한 TLS 암호화 및 AAA (인증, 권한 부여 및 감사) 도구를 제공하여,   
서비스와 데이터를 보호한다. Istio 보안의 목표는 다음과 같다.   
   
- 기본적으로 보안 : 애플리케이션 코드 및 인프라를 변경할 필요가 없다.
- 심층 방어 : 기존 보안 시스템과 통합하여 여러 계층의 방어를 제공한다.
- 제로 트러스트 네트워크 : 비 신뢰 네트워크에 보안 솔루션 구축
   
배포된 서비스에서 Istio 보안 기능을 사용하려면,   
상호 TLS 마이그레이션 문서를 방문하시오.    
보안기능 사용에 대한 자세한 지침은 보안 작업을 참조하시오.
   
## 상위수준 아키텍처
Istio의 보안에는 여러 구성요소가 포함된다.   
   
- 키 및 인증 관리를위한 인증 기관 (CA)
- 구성 API 서버는 프록시에 분배한다.
  - 인증정책
  - 권한정책
  - 안전한 이름 정보   
- 사이드카 및 주변 프록시는 클라이언트와 서버간의 통신 보호를 위해 PEP (Policy Enforcement Point)로 작동한다.
- 원격분석 및 감사 관리를 위한 Envoy 프록시 확장 세트   
   
Control Plane은 API서버의 구성을 처리하고,   
데이터 플레인에서 PEP를 구성한다.    
PEP는 Envoy를 사용하여 구현된다. 다음 다이어그램은 아키텍처를 보여준다.   
![Istio 보안 아키텍처](https://istio.io/latest/docs/concepts/security/arch-sec.svg)  
   
다음 섹션에서는 Istio 보안 기능에 대해 자세히 설명한다.   
   
## Istio 아이덴티티   
아이덴티티는 모든 보안 인프라의 기본 개념이다.    
워크로드와 워크로드 간의 통신이 시작될 때,   
두 당사자는 상호인증을 위해 신원 정보와 신임정보를 교환해야한다.   
클라이언트 측에서,   
서버의 ID는 안전한 이름지정 정보와 비교하여   
서버가 워크로드의 승인된 실행자인지 확인한다.   
서버 측에서,   
서버는 권한부여 정책을 기반으로    
클라이언트가 액세스 할 수있는 정보를 결정하고,    
몇시에 액세스했는지 감사하고,    
사용한 워크로드에 따라 클라이언트를 청구하며,    
청구서에 액세스하지 못한 클라이언트를 거부 할 수 있다.   
   
Istio 아이덴티티 모델은 first class 서비스 아이덴티티를 사용하여 요청 출처의 아이덴티티를 결정한다.   
이 모델을 통해 서비스 아이덴티티가 사람 사용자, 개별 워크로드 또는 워크로드 그룹을 나타낼 수 있는   
뛰어난 유연성과 세분성을 제공 할 수 있다.    
서비스 아이덴티티가 없는 플랫폼에서   
Istio는 서비스 이름과 같은 워크로드 인스턴스를 그룹화 할 수 있는 다른 아이덴티티를 사용할 수 있다.   
   
다음 목록은 다른 플랫폼에서 사용할 수있는 서비스 아이덴티티의 예를 보여준다.

- Kubernetes : Kubernetes 서비스 계정
- GKE / GCE : GCP 서비스 계정
- GCP : GCP 서비스 계정
- AWS : AWS IAM 사용자 / 역할 계정
- 온-프레미스 (쿠 버넷 이외) : 사용자 계정, 사용자 지정 서비스 계정, 서비스 이름, Istio 서비스 계정 또는 GCP 서비스 계정 사용자 정의 서비스 계정은 고객의 Identity Directory에서 관리하는 아이디와 같은 기존 서비스 계정을 나타낸다.   
   
## 신원(Identity) 및 인증서 관리
Istio는 X.509 인증서를 사용하여 모든 워크로드에 강력한 ID를 안전하게 프로비저닝한다.    
각 Envoy 프록시와 함께 실행되는 Istio 에이전트는    
istiod와 함께 작동하여 키 및 인증서 순환을 대규모로 자동화한다.   
다음 다이어그램은 자격 증명 제공 흐름을 보여준다.

![Istio 아이디 프로비저닝](https://istio.io/latest/docs/concepts/security/id-prov.svg) 
